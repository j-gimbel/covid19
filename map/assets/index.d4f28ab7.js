import{s as e,a as t,b as n,r as o,o as a,u as s,c as r,d as l,e as i,w as c,f as p,g as d,h as u,t as m,i as h,j as w,k as g,l as A}from"./vendor.99ba7f46.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const o=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,s)=>{const r=new URL(e,o);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const l=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){s(new Error(`Failed to import: ${e}`)),a(i)},onload(){n(self[t].moduleMap[r]),a(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/map/assets/");const D={components:{LMap:e,LTileLayer:t,LGeoJson:n,Plotly:Plotly},setup(e){const t=s(),n={weight:1,color:"#808080"},r={color:"#333",weight:2},l={color:"#cc0000",weight:2};var i=null,c=null;const p=o(!1),d=o({}),u=e=>{console.log("whenClicked",e);var o=e.target;if(null!=i&&(i.setStyle(n),i.feature.properties.id==o.feature.properties.id))return i=null,void t.commit("map/setLKID",null);i=o,t.dispatch("map/loadLKData",o.feature.properties.id),t.dispatch("map/loadLKDataDetails",o.feature.properties.id),o.setStyle(l)},m=e=>{var n=e.target;c=n,null!=i&&i.feature.properties.id==n.feature.properties.id||(t.commit("map/setHoveredLKName",c.feature.properties.name),n.setStyle(r))},h=e=>{var t=e.target;null!=i&&i.feature.properties.id==t.feature.properties.id||t.setStyle(n)};return a((async()=>{var e=new Headers;e.append("pragma","no-cache"),e.append("cache-control","no-cache"),e.append("Content-Type","application/json"),e.append("Accept","application/json");var t={method:"GET",headers:e},n=new Request("landkreise_rki.geojson");fetch(n,t).then((e=>e.json())).then((function(e){d.value=e,p.value=!0}))})),{geojson:d,geoJsonloaded:p,geojsonOptions:{onEachFeature:(e,t)=>{t.on({click:u,mouseover:m,mouseout:h})},style:e=>({color:"#808080",weight:1})}}}};D.render=function(e,t,n,o,a,s){const u=r("l-geo-json"),m=r("l-tile-layer"),h=r("l-map");return l(),i(h,{zoom:7,center:[51.4,10.4]},{default:c((()=>[o.geoJsonloaded?(l(),i(u,{key:0,geojson:o.geojson,options:o.geojsonOptions},null,8,["geojson","options"])):p("",!0),d(m,{url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"})])),_:1},8,["center"])};const L={components:{},setup(){const e=s();return{LKName:u((()=>e.state.map.LKName))}}},_=d("h3",null,"Info",-1),f=h(" Landkreis: ");L.render=function(e,t,n,o,a,s){return l(),i("div",null,[_,d("div",null,[f,d("span",null,m(o.LKName),1)])])};const K={components:{},setup(){const e=s(),t=u((()=>e.state.map.LKDataDetails));return w(t,((t,n)=>{console.log("watch LKDataDetails",t,n);let o=e.state.map.LKDataDetails;console.log(o),window.Plotly.newPlot(document.getElementById("chart2"),[{x:o.dates,y:o.incidences,name:"incidences"}],{title:"7 Day avg. incidence"},{responsive:!0})})),{LKDataDetails:t}}},v={id:"chart2"};K.render=function(e,t,n,o,a,s){return l(),i("div",v)};const y={components:{},setup(){const e=s(),t=u((()=>e.state.map.LKData));w(t,((t,n)=>{console.log("watch",t,n);let o=e.state.map.BRData;window.Plotly.newPlot(document.getElementById("chart1"),[{x:["AG 0-4","AG 5-14","AG 15-34","AG 35-59","AG 60-79","AG 80+"],y:[o.Einwohner_AG_A00_A04/o.Einwohner*100,o.Einwohner_AG_A05_A14/o.Einwohner*100,o.Einwohner_AG_A15_A34/o.Einwohner*100,o.Einwohner_AG_A35_A59/o.Einwohner*100,o.Einwohner_AG_A60_A79/o.Einwohner*100,o.Einwohner_AG_A80Plus/o.Einwohner*100],name:"Germany",type:"bar"},{x:["AG 0-4","AG 5-14","AG 15-34","AG 35-59","AG 60-79","AG 80+"],y:[t.Einwohner_AG_A00_A04/t.Einwohner*100,t.Einwohner_AG_A05_A14/t.Einwohner*100,t.Einwohner_AG_A15_A34/t.Einwohner*100,t.Einwohner_AG_A35_A59/t.Einwohner*100,t.Einwohner_AG_A60_A79/t.Einwohner*100,t.Einwohner_AG_A80Plus/t.Einwohner*100],name:e.state.map.LKName,type:"bar"}],{title:"Age groups distribution"},{responsive:!0})}));return a((()=>{console.log("loadGlobalData"),e.dispatch("map/loadBRData")})),{LKData:t}}},G={id:"chart1"};y.render=function(e,t,n,o,a,s){return l(),i("div",G)};const E={class:"container-fluid vh-100 p-0"},j={class:"row vh-100"},R={class:"col-7"},b={class:"col-5"},P={expose:[],setup:e=>(e,t)=>(l(),i("div",E,[d("div",j,[d("div",R,[d(D)]),d("div",b,[d(L),d(K),d(y)])])]))};var k=g({modules:{map:{namespaced:!0,state:{url:"http://j-gimbel.ddns.net:8000",LKID:null,LKName:"",BRData:null,LKData:null,LKDataDetails:null,LKIncidence:null},getters:{},actions:{async getGeojson({commit:e,state:t}){console.log("getGeojson");var n=new Headers;n.append("pragma","no-cache"),n.append("cache-control","no-cache"),n.append("Content-Type","application/json"),n.append("Accept","application/json");var o={method:"GET",headers:n},a=new Request("landkreise_rki.geojson");return new Promise((t=>{fetch(a,o).then((e=>e.json())).then((function(n){console.log(n),e("setGeojson",n),t(n)}))}))},loadLKData:async({commit:e,state:t},n)=>new Promise(((o,a)=>{fetch(t.url+"/api/landkreis/"+n,{mode:"cors"}).then((e=>e.json())).then((function(t){console.log(t),e("setLKID",n),e("setLKData",t),o(t)}))})),loadLKDataDetails:async({commit:e,state:t},n)=>new Promise(((o,a)=>{var s=new URL(t.url+"/api/landkreis/"+n+"/timeline");s.searchParams.append("params",JSON.stringify(["incidence"])),fetch(s,{mode:"cors"}).then((e=>e.json())).then((function(t){console.log(t),e("setLKDataDetails",t),o(t)}))})),loadBRData:async({commit:e,state:t})=>new Promise(((n,o)=>{null==t.BRData?fetch(t.url+"/api/bundesrepublik",{mode:"cors"}).then((e=>e.json())).then((function(t){console.log(t),e("setBRData",t),n(!0)})):n(!0)}))},mutations:{setLKID(e,t){e.LKID=t},setBRData(e,t){console.log("setBRData",t),e.BRData=t},setLKData(e,t){console.log("setLKData",t),e.LKData=t},setLKDataDetails(e,t){console.log("setLKDataDetails",t),e.LKDataDetails=t},setHoveredLKName(e,t){console.log("setHoveredLKName",t),e.LKName=t}}}},strict:!1,plugins:[]});const B=A(P);B.use(k),B.mount("#app");
